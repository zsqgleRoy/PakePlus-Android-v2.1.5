import{d as B,u as F,h as d,v as h,S as _,o as U,a as e,c as o,b as c,e as I,w as y,F as k,r as f,k as i,f as E,l as W,p as q,i as v,q as H,t as P}from"./index-B90foI-Y.js";import{s as T}from"./format-BrnGdaLm.js";import{W as A}from"./WebsiteCard-DcUVVhpR.js";import{_ as D}from"./_plugin-vue_export-helper-DlAUqK2U.js";const K={class:"search-page page-container"},G={class:"search-header"},L={key:0,class:"search-results"},M={key:0,class:"results-list"},O={key:1,class:"search-history"},Y={class:"history-header"},$={key:0,class:"history-tags"},j=B({__name:"Search",setup(z){const S=W(),g=F(),s=d(""),u=d(!1),a=d(h.get(_.USER_PREFERENCES+"_search_history")||[]),p=q(()=>s.value.trim()?T(s.value):[]);U(()=>{const t=S.query.keyword;t&&(s.value=t,n())});const C=()=>{u.value=!1},n=()=>{s.value.trim()&&(u.value=!0,a.value.includes(s.value)||(a.value.unshift(s.value),a.value.length>10&&(a.value=a.value.slice(0,10)),h.set(_.USER_PREFERENCES+"_search_history",a.value)))},R=t=>{s.value=t,n()},w=()=>{a.value=[],h.set(_.USER_PREFERENCES+"_search_history",[])},N=t=>{g.addVisitRecord({websiteId:t.id,websiteName:t.name,websiteUrl:t.url,visitTime:Date.now()}),window.open(t.url,"_blank")};return(t,l)=>{const V=v("van-search"),m=v("van-empty"),b=v("van-tag");return e(),o("div",K,[c("div",G,[I(V,{modelValue:s.value,"onUpdate:modelValue":l[0]||(l[0]=r=>s.value=r),placeholder:"搜索网站名称或描述",shape:"round",autofocus:"",onSearch:n,onInput:C},{action:y(()=>[c("div",{onClick:n},"搜索")]),_:1},8,["modelValue"])]),s.value.trim()?(e(),o("div",L,[p.value.length>0?(e(),o("div",M,[(e(!0),o(k,null,f(p.value,r=>(e(),i(A,{key:r.id,website:r,onClick:N},null,8,["website"]))),128))])):u.value?(e(),i(m,{key:1,description:"未找到相关网站",image:"search"})):E("",!0)])):(e(),o("div",O,[c("div",Y,[l[1]||(l[1]=c("span",{class:"title"},"搜索历史",-1)),a.value.length>0?(e(),o("span",{key:0,class:"clear-btn",onClick:w}," 清空 ")):E("",!0)]),a.value.length>0?(e(),o("div",$,[(e(!0),o(k,null,f(a.value,(r,x)=>(e(),i(b,{key:x,class:"history-tag",onClick:J=>R(r)},{default:y(()=>[H(P(r),1)]),_:2},1032,["onClick"]))),128))])):(e(),i(m,{key:1,description:"暂无搜索历史",image:"search"}))]))])}}}),se=D(j,[["__scopeId","data-v-83da17ea"]]);export{se as default};
